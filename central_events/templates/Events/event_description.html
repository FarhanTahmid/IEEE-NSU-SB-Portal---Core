<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Events | IEEE NSU Student Branch</title>
    <link rel="icon" href="{% static 'logos/logo.gif' %}"/>

    {% block common_css %}
        {% include "common_css.html" %}
    {% endblock common_css %}

    <link rel="stylesheet" href="{% static 'newTable.css' %}" type="text/css" />


    <style>
        body, html {
        
        margin: 0;
        
        align-items: center;
        justify-content: center;
        }

        .row {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        }
        .row {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
          }
          .btn-container {
            text-align: center;
          }
          
          .btn {
            max-width: 100%;
            width: auto;
            display: inline-block;
            white-space: normal; /* Allow text to wrap within the button */
            word-wrap: break-word; /* Break long words if necessary */
            font-size: 16px; /* Adjust the font size as needed */
          }
          
          /* Media query for smaller screens (adjust the breakpoint as needed) */
          @media (max-width: 768px) {
            .btn {
              width: 100%; /* Make the button full width on smaller screens */
            }
          }
          .slide-button{
            width: 100px;
            height: 50px;
            position: absolute;
            top: 145px;   /* Set the top property to 0 to position at the top */
            right:50px ;
          }
        
    </style>
</head>
<body>
    <!-- ############ LAYOUT START-->
    <div class="app" id="app">

        <!-- aside -->
        <div id="aside" class="app-aside modal nav-dropdown">
  
  	        {% block sidebar %}
	            {% include 'users/sidebar.html' %}
  	        {% endblock %}
  
        </div>
        <!-- aside end -->
  
        <!-- navbar content -->
        <div id="content" class="app-content box-shadow-z0" role="main">
          {% if is_branch %}
            {% block navbar %}
                {% include 'navbar.html' %}
            {% endblock navbar %}
          {% else %}
            {% block sc_ag_navbar %}
              {% include 'sc_ag_navbar.html' %}
            {% endblock sc_ag_navbar %}
          {% endif %}
        </div>
        <!--navbar content-->
        
        <!-- ############ PAGE START-->
        <div ui-view class="app-body" style="justify-content:center; margin-left:15%; margin-right:15%;" id="view">


            <br>
            <h1 style="justify-content:center;text-align:center;margin-bottom:15px;"><span style="color:#00629B;"><b>{{event_details.event_name}}</b></span></h1>
            <h2 style="justify-content:center;text-align:center;margin-bottom:15px;">Organised By: <span style="color:#00629B;"><b>{{event_details.event_organiser.group_name}}</b></span>.</h4>
              <div class = "slide-button">
                <h3 class = "text-success text-center"></h3>
                <form method="POST" id="form-submit">
                    {% csrf_token %}
                    <label class="form-control-label"><b>Publish:</b></label>
                    <span>                                    
                    <label class="ui-switch m-t-xs m-r">
                        <input id="publish_event" name="publish_event" type="checkbox" {% if is_published %} checked {% endif %}>
                          <i></i>
                    </label>                
                    </span>
                  </form>
              </div>
            {% if hasCollaboration %}
              <h5 style="justify-content:center;text-align:center;margin-bottom:15px;">In Collaboration With:</h4>
              {% for i in interBranchCollaborations %}
              <h5 style="justify-content:center;text-align:center;margin-bottom:15px;"><span style="color:#00629B;">{{i.collaboration_with.group_name}}</span></h4>
              {% endfor %}
              {% for i in intraBranchCollaborations %}
              <h5 style="justify-content:center;text-align:center;margin-bottom:15px;"><span style="color:#00629B;">{{i.collaboration_with}}</span></h4>
            {% endfor %}
            {% endif %}

            
            <br><br>
            <!-- Add Delete Button -->
            <div class="btn-container">
              <button class="btn btn-outline-danger" data-toggle="modal" data-target="#deleteModal">Delete Event</button>
            </div>
            

            <!-- Confirm Delete Modal -->
            <div id="deleteModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                  <div class="modal-content">
                      <div class="modal-header">
                          <h5 class="modal-title" id="deleteModalLabel">Confirm Delete</h5>
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                              <span aria-hidden="true">&times;</span>
                          </button>
                      </div>
                      <form method="post">
                        {% csrf_token %}
                      <div class="modal-body">
                          <p>Are you sure you want to delete this event?</p>
                      </div>
                      <div class="modal-footer">
                          <input type="submit" class="btn btn-outline-danger buttons"  value="Delete" name="delete_event">
                          <button class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                      </div>
                    </form>
                  </div>
              </div>
            </div>
            
            
        </div>
        <!--PAGE END-->

        

        

    

        <!--Theme Switcher-->

        {% block theme_switcher %}
            {% include "theme_switcher.html" %}
        {% endblock theme_switcher %}
    
    </div>
    <!-- app end-->

    {% block common_js %}
        {% include "common_js.html" %}
    {% endblock common_js %}

    <script src="{% static 'table_search.js'%}"></script>

    <script>
      $(document).ready(function() {
        // Attach a change event listener to the checkbox
        $('input[name="publish_event"]').change(function() {
            // Get the current state of the checkbox (checked or not)
            var switchStatus = $(this).prop('checked');
            console.log(switchStatus);
            $.ajax({
              type:'POST',
              {% if is_branch %}
              url: '{% url 'central_branch:event_published' event_id %}',
              {% else %}
              url: '{% url 'chapters_and_affinity_group:event_published_sc_ag' sc_ag_info.primary event_id %}',
              {% endif %}
              data:{
                'publish_event': switchStatus ? 'on' : 'off',
                'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val()
              },
              success: function(data){
                console.log('Ajax request successful:', data);
              }
            });
            $('#publishForm').submit(function(event) {
              event.preventDefault();
              // Handle the form submission with AJAX if needed
            });
            
            
        });
  
    });




      function showDeleteModal() {
          var modal = document.getElementById('deleteModal');
          modal.style.display = 'block';
      }
  
      function closeDeleteModal() {
          var modal = document.getElementById('deleteModal');
          modal.style.display = 'none';
      }
  
      function deleteEvent() {
          // Add logic here to delete the event
          // You may want to make an AJAX request to the server to perform the actual deletion
          // After deletion, you can redirect the user or update the UI as needed
          // For simplicity, this example just closes the modal
          closeDeleteModal();
      }


  </script>

</body>
</html>
