<!DOCTYPE html>
{% load static %}
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="{% static 'team_details_page.css' %}">
    </head>
    <body>
        <h1>{{team_name}}</h1>
        <form method="POST" action="">
        {% csrf_token %}
        <a href="#divOne" class="btn">Add Member to team</a>
        </form>

        <a href="{% url 'central_branch:manage_team' team_id team_name %}" class="btn">Manage Team</a>
        
        <h3>Current Team Members:</h3>
        <label>Search: </label>
        <input type="text" onkeyup="searchfunction()" id="search" placeholder="Search with any credentials">
        
        <br>
        <table id="member_table">
            <thead>
                <tr id="table_row">
                    <th>IEEE ID</th>
                    <th>NSU ID</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Current Position</th>
                    <th>Contact No.</th>
                    
                </tr>
            </thead>
        {% comment %} This block is responsible for loading all the members recruited on that session and passes their id to the url as well as their data to the recruitee_details function {% endcomment %}
        {% for member in team_members %}
            <tr>
                <td><a href="">{{ member.ieee_id }}</a></td>
                <td>{{ member.nsu_id }}</td>
                <td>{{ member.name }}</td>
                <td>{{ member.email_ieee }}</td>
                <td>{{ member.position.role }}</td>
                <td>0{{ member.contact_no }}</td>
                
            </tr>
        {% endfor %}
        </table>
        <p id="no_data"></p>



        {% comment %} POPUP FOR ADDING MEMBERS START {% endcomment %}
        
        <div class="overlay" id="divOne">
            <div class="wrapper">
              <h2>Add member to the team</h2><a class="close" href="#">&times;</a>
              <div class="content">
                <div class="container">
                  
                  <form method="POST" action="">
                    {% csrf_token %}
                    <label>Position</label>
                    <select id="position" name="position">
                        {% for position in positions %}
                            <option value={{position.id}}>{{ position.role }}</option>
                        {% endfor %} 
                    </select>
                    <br>
                    <label>Search Members: </label>
                    <input type="text" onkeyup="search_member_function()" id="search_member" placeholder="Search with any credentials">
        
                    <br>
                    <div class="scroll">
                        <div>
                            <table id="registered_member_table" class="insb_member_table">
                                <h3 style="text-align:center">Members</h3>
                                <thead>
                                    <tr id="table_row">
                                        <th class="insb_member_table_head">Name</th>
                                        <th class="insb_member_table_head">IEEE ID</th>
                                        <th class="insb_member_table_head">NSU ID</th>
                                        <th class="insb_member_table_head">Email</th>
                                        <th class="insb_member_table_head">Contact No.</th>
                                        <th class="insb_member_table_head">Select Member</th>
                                        
                                    </tr>
                                </thead>
                            {% comment %} This block is responsible for loading all the members recruited on that session and passes their id to the url as well as their data to the recruitee_details function {% endcomment %}
                            {% for member in insb_members %}
                                <tr>
                                    <td class="insb_member_table_data">{{ member.name }}</td>
                                    <td class="insb_member_table_data">{{ member.ieee_id }}</td>
                                    <td class="insb_member_table_data">{{ member.nsu_id }}</td>
                                    <td class="insb_member_table_data">{{ member.email_ieee }}</td>
                                    <td class="insb_member_table_data">0{{ member.contact_no }}</td>
                                    <td class="insb_member_table_data">
                                        <input type="checkbox" id="select" name="member_select" value={{member.ieee_id}}>
                                    </td>
                                </tr>
                            {% endfor %}
                            </table>
                            <p  id="no_data1" style="text-align:center;"></p>
                        </div>
                    </div>
                    <br> 
                    {% for message in messages %}
                        <p>{{message}}</p>
                    {% endfor %}
                    <input type="submit" value="Add to Team" class="add_to_team" name="add_to_team">
                  </form>
                  
                </div>
              </div>
            </div>
          </div>
    <script>
        function search_member_function(){
            let input,filter,table,tr,td,j;
            input=document.getElementById("search_member");
            filter=input.value.toUpperCase();
            table=document.getElementById("registered_member_table");
            tr=table.getElementsByTagName("tr");
            
            for(j=0;j<tr.length;j++){
                td=tr[j].getElementsByTagName("td");
                message=document.getElementById("no_data1");
    
                if(td.length > 0){
                    if(td[0].innerHTML.toLocaleUpperCase().indexOf(filter)> -1 ||
                    td[1].innerHTML.toLocaleUpperCase().indexOf(filter)> -1 ||
                    td[2].innerHTML.toLocaleUpperCase().indexOf(filter)> -1 ||
                    td[3].innerHTML.toLocaleUpperCase().indexOf(filter)> -1 ||
                    td[4].innerHTML.toLocaleUpperCase().indexOf(filter)> -1 ||
                    td[5].innerHTML.toLocaleUpperCase().indexOf(filter)> -1){
                    tr[j].style.display="";
                    message.innerHTML="";
                }
                        else{
                            tr[j].style.display="none";
                        }
                
                }        
                if(td.length==0){
                    message.innerHTML="Member not found!";
                }
            }
        }

        function searchfunction(){
            let input,filter,table,tr,td,j;
            input=document.getElementById("search");
            filter=input.value.toUpperCase();
            table=document.getElementById("member_table");
            tr=table.getElementsByTagName("tr");
            
            for(j=0;j<tr.length;j++){
                td=tr[j].getElementsByTagName("td");
                message=document.getElementById("no_data");
    
                if(td.length > 0){
                    if(td[0].innerHTML.toLocaleUpperCase().indexOf(filter)> -1 ||
                    td[1].innerHTML.toLocaleUpperCase().indexOf(filter)> -1 ||
                    td[2].innerHTML.toLocaleUpperCase().indexOf(filter)> -1 ||
                    td[3].innerHTML.toLocaleUpperCase().indexOf(filter)> -1 ||
                    td[4].innerHTML.toLocaleUpperCase().indexOf(filter)> -1){
                    tr[j].style.display="";
                    message.innerHTML="";
                }
                        else{
                            tr[j].style.display="none";
                        }
                
                }        
                if(td.length==0){
                    message.innerHTML="Member not found!";
                }
            }
        }
    
    </script>
    </body>
</html>