from smtplib import SMTPException
import socket
from django.conf import settings
from system_administration.render_access import Access_Render
from django.core.mail import send_mail
from . import renderData

def send_emails_to_officials_upon_site_registration_request(request,name,ieee_id,position,team_name,official_name,recipent):

    try:
            # Send an Email now
            subject = "New Portal Registration Request"
            # Getting the site domain
            site_domain = request.META['HTTP_HOST']
            message = f"Dear {official_name},\nYou have recieved a new portal registration request by\nName: {request.POST['name']}\nIEEE ID: {ieee_id}\nTeam:{team_name}\nPosition:{position}\n\nTo verify/approve this request, please follow the link below:\n{site_domain}/membership_development_team/insb_members/site_registration/request_details/{request.POST['ieee_id']}\n\nThis email notification was auto generated by the Portal Website of INSB. If you are not responsible for this particular task, please contact the system admin of IEE NSU SB portal website.\nThank you."
            email_from = settings.EMAIL_HOST_USER
            recipient_list = [recipent]
            send_mail(
                subject, message, email_from, recipient_list
            )
            return True
    except SMTPException as e:
        return False

def send_email_on_site_registration_verification_to_user(request,new_member_name,new_member_personal_mail):
    try:
        #Send an Email now
        subject="Site Registration Request Approved"
        #Getting the site domain
        site_domain=request.META['HTTP_HOST']
        message=f"Dear {new_member_name}, Welcome aboard!\nYour request to join IEEE NSU SB's new Portal Website has been Approved! Please redirect to the site to Signup With your IEEE ID using this link: {site_domain}/users/signup\nThank You."
        email_from=settings.EMAIL_HOST_USER
        recipient_list=[new_member_personal_mail,]
        send_mail(
                subject,message,email_from,recipient_list
        )
        return True
    except SMTPException as e:
        return False
